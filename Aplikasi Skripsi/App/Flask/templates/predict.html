{% with judul="Predict" %}
    {% include "component/header.html" %}
{% endwith %}

  <body>
    {% include "component/navbar.html" %}

    <div class="loading max-w-screen-lg mx-auto pb-10 flex justify-center" style="display: none;">
      <img src="../static/img/loading.gif" class="mx-auto rounded-full">
      <p class="absolute top-80 text-black font-bold">Mohon tunggu, data sedang diproses...</p>
    </div>
    <div class="content px-24 py-5">
      <h2 class="normal-case text-2xl font-bold text-center pb-8">Halaman Predict <br> Analysis Pemilihan Calon Presiden 2024</h2>
      
      <div class="bg-orange-100 p-10 border-2 border-black rounded-md mx-auto w-2/3">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Masukan Data Twitter</p>
    
        {% with messages = get_flashed_messages() %}
          {% if messages %}
              {% for message in messages %}
                  <p class="text-red-700 text-lg font-bold mb-7">Error!! {{ message }}</p>
              {% endfor %}
          {% endif %}
        {% endwith %}

        <p class="normal-case text-lg mt-8">Pilih Tipe Input</p>
        
        <div class="selection mb-10">
          <div class="radio text-lg text-cyan-800">
            <input type="radio" id="radio1" value="1" name="radio" checked>
            <label for="radio1">Input File</label>
          </div>
          <div class="radio text-lg text-cyan-800">
            <input type="radio" id="radio2" value="2" name="radio">
            <label for="radio2">Input Text</label>
          </div>
        </div>
        
        <div class="form-file">
          <form action="/predict" id="form-file" method="post" enctype="multipart/form-data">
            <div class="form-input py-4">
              <input type="file" name="file" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100"/>
              <button type="submit" onclick="loading()" class="btn hover:cursor-pointer font-bold bg-violet-400 px-2 py-2 mt-4 rounded-lg w-52">Predict File Data</button>
              {% if status == 'complete' and not data['result'] and not data['processed_features'] %}
              <button onclick="location.href='/saveFilePredict'" type="button" class="btn hover:cursor-pointer font-bold bg-blue-400 px-2 py-2 rounded-lg">Unduh File Test disini</a>                            
              {% endif %}
              {% if status != 'complete' %}
              <p class="normal-case text-md text-grey mt-10 flex justify-start">*Note Data harus dalam bentuk Excel!</p>
              {% endif %}
            </div>            
          </form>
        </div>
    
        <div class="form-text hidden">
          <form action="/predictt" id="form-text" method="post">
            <textarea name="text" cols="30" rows="10" disabled class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Masukan Tweet untuk diprediksi..."></textarea>
            <button type="submit" onclick="loading()" class="btn hover:cursor-pointer font-bold bg-violet-400 px-2 py-2 mt-4 rounded-lg w-52" disabled>Predict Tweet</button>
          </form>
        </div>

        {% if status == 'complete' and not data['result'] and not data['processed_features'] %}
        
        <div class="content">
          <div class="Predict_chart bg-white rounded-lg my-3 p-4 w-full">
            <p class="normal-case text-xl font-bold mb-2 flex justify-center">Chart Predict Data</p>
            <div class="chart-container h-96">
              <canvas id="pieChart1"></canvas>
            </div>
          </div>
          {% if countPositive > 0 %}
          <div class="positive_wordcloud relative bg-white rounded-lg my-3 p-4 w-full">
            <p class="normal-case text-xl font-bold mb-2 flex justify-center">Positive Word</p>
            <div class="flex justify-center">
              <img src="{{ url_for('save_predwordcloud_image', name = 'Positive') }}" alt="WordCloud Image">
            </div>
          </div>
          {% endif %}
          {% if countNetral > 0 %}
          <div class="netral_wordcloud relative bg-white rounded-lg my-3 p-4 w-full">
            <p class="normal-case text-xl font-bold mb-2 flex justify-center">Netral Word</p>
            <div class="flex justify-center">
              <img src="{{ url_for('save_predwordcloud_image', name = 'Netral') }}" alt="WordCloud Image">
            </div>
          </div>
          {% endif %}
          {% if countNegative > 0 %}
          <div class="negative_wordcloud relative bg-white rounded-lg my-3 p-4 w-full">
            <p class="normal-case text-xl font-bold mb-2 flex justify-center">Negative Word</p>
            <div class="flex justify-center">
              <img src="{{ url_for('save_predwordcloud_image', name = 'Negative') }}" alt="WordCloud Image">
            </div>
          </div>            
          {% endif %}
        </div>
        {% elif status == 'complete' and data['result'] and data['processed_features'] %}
        <p class="normal-case text-xl font-bold mb-2">Hasil Preprocessing : "{{data['processed_features'][0]}}"</p>
        <p class="normal-case text-xl font-bold mb-2">Sentiment : {{ data['result'] }}</p>
        {% endif %}        
      </div>
    </div>
    
    {% if status == 'complete' and not data['result'] and not data['processed_features'] %}
    <script>
        let data = JSON.parse({{ data| tojson | safe }})
    </script>
    {% elif status == 'complete' %}
    <script>
      endLoading();
    </script>
    {% endif %}
     
    
    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/chartJs.js"></script>
    <script src="../static/js/predictScript.js"></script>
    <script src="../static/js/loadingScript.js"></script>      
  </body>
</html>
