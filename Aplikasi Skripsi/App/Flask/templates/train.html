{% with judul="Train" %}
{% include "component/header.html" %}
{% endwith %}

<body>
  <div class="navbar">
    <div class="px-10 py-0 mb-10 bg-blue-100 border-2 border-b-orange-600">
        <a class="btn normal-case text-sm rounded-md px-3 py-2 hover:text-black hover:font-bold" href="/scrap">Scrap</a>
        <a class="btn normal-case text-sm rounded-md px-3 py-2 hover:text-black hover:font-bold" href="/train">Train</a>
        <a class="btn normal-case text-sm rounded-md px-3 py-2 hover:text-black hover:font-bold" href="/predict">Predict</a>
    </div>
  </div>
  
  <div class="loading max-w-screen-lg mx-auto pb-10 flex justify-center" style="display: none;">
    <img src="../static/img/loading.gif" class="mx-auto rounded-full">
    <p class="absolute top-80 text-black font-bold">Mohon tunggu, data sedang diproses...</p>
  </div>
  <div class="content px-24 py-5">
    <h2 class="normal-case text-2xl font-bold text-center pb-8">Halaman Train Data <br> Sentiment Analysis Pemilihan Calon Presiden 2024</h2>

    <div class="bg-orange-100 p-10 border-2 border-black rounded-md mx-auto w-2/3">
      <p class="normal-case text-xl font-bold mb-2 flex justify-center">Masukan data yang telah dilabeling</p>

      {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
                <p class="text-red-700 text-lg font-bold mb-7">Error!! {{ message }}</p>
            {% endfor %}
        {% endif %}
      {% endwith %}
      
      <form action="/train" method="post" enctype="multipart/form-data">
        <div class="form-input py-4">
          <input type="file" name="file" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100"/>
          <button type="submit" onclick="loading()" class="btn hover:cursor-pointer font-bold bg-violet-400 px-2 py-2 mt-4 rounded-lg w-52">Train Model</button>
          <!-- {% if status == 'complete' %}
          <button onclick="location.href='/saveFileTest'" type="button" class="btn hover:cursor-pointer font-bold bg-blue-400 px-2 py-2 rounded-lg">Unduh File Test disini</a>                            
          {% endif %} -->
          {% if status != 'complete' %}
          <p class="normal-case text-md text-grey mt-10 flex justify-start">*Note Data harus dalam bentuk Excel!</p>
          {% endif %}
        </div>
      </form>

      {% if status == 'complete' %}
      <div class="df_table relative bg-white rounded-lg p-4">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Tabel DF</p>
        <table id="table1" class="table table-striped">
          <thead>
            <th>
              Word
            </th>
            <th>
              DF Value
            </th>
          </thead>
          <tbody>
            {% for item in df_value %}
            <tr>
              <td>{{ item['word'] }}</td>
              <td>{{ item['df'] }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="kfold_chart relative bg-white rounded-lg my-3 p-4 ">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Fold Score</p>
        <div class="chart-container h-96">
          <canvas id="barChart"></canvas>
        </div>
      </div>
      <div class="bestfold_chart bg-white rounded-lg my-3 p-4 w-full">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Chart Predict Data</p>
        <div class="chart-container h-96">
          <canvas id="pieChart"></canvas>
        </div>
        <p class="normal-case text-sm my-2">*note : Data diatas berasal dari fold ke - {{ fold }}</p>
      </div>
      <div class="confusion_matrix relative bg-white rounded-lg my-3 p-4 w-full">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Confusion Matrix</p>
        <div class="flex justify-center">
          <img src="{{ url_for('save_trainPlot_image') }}" alt="Plot Image">
        </div>
        <p class="normal-case text-sm my-2">*note : Data diatas berasal dari fold ke - {{ fold }}</p>
      </div>
      <div class="hyperplane_plot relative bg-white rounded-lg my-3 p-4 w-full">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">SVM Area</p>
        <div class="flex justify-center">
          <img src="{{ url_for('save_trainChart_image') }}" alt="Plot Image">        
        </div>
        <p class="normal-case text-sm my-2">*note : Data diatas berasal dari fold ke - {{ fold }}</p>
      </div>
      <div class="positive_wordcloud relative bg-white rounded-lg my-3 p-4 w-full">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Positive Word</p>
        <div class="flex justify-center">
          <img src="{{ url_for('save_wordcloud_image', name = 'Positive') }}" alt="WordCloud Image">
        </div>
        <p class="normal-case text-sm my-2">*note : Data diatas berasal dari fold ke - {{ fold }}</p>
      </div>
      <div class="netral_wordcloud relative bg-white rounded-lg my-3 p-4 w-full">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Netral Word</p>
        <div class="flex justify-center">
          <img src="{{ url_for('save_wordcloud_image', name = 'Netral') }}" alt="WordCloud Image">
        </div>
        <p class="normal-case text-sm my-2">*note : Data diatas berasal dari fold ke - {{ fold }}</p>
      </div>
      <div class="negative_wordcloud relative bg-white rounded-lg my-3 p-4 w-full">
        <p class="normal-case text-xl font-bold mb-2 flex justify-center">Negative Word</p>
        <div class="flex justify-center">
          <img src="{{ url_for('save_wordcloud_image', name = 'Negative') }}" alt="WordCloud Image">
        </div>
        <p class="normal-case text-sm my-2">*note : Data diatas berasal dari fold ke - {{ fold }}</p>
      </div>        
    </div>
  </div>
  {% endif %}
  
  <script src="../static/js/jquery.min.js"></script>
  <script src="../static/js/loadingScript.js"></script>

  {% if status == 'complete' %}
  <script>
    let all_fold = JSON.parse({{ all_fold| tojson | safe }})
    let best_fold = JSON.parse({{ best_fold| tojson | safe }})
    endLoading();
  </script>

  <script src="../static/js/chartJs.js"></script>
  <script src="../static/js/datatables.min.js"></script>
  <script src="../static/js/trainScript.js"></script>
  {% endif %}
  

</body>

</html>